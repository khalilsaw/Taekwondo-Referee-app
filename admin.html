<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
  </head>

  <body class="p-3 mb-2 bg-secondary text-white">
    <div
      class="popup"
      style="
        display: none;
        width: 500px;
        box-shadow: 0 0 20px 10px rgba(0, 0, 0, 0.5);
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1;
        padding: 20px;
        border: 1px solid black;
        border-radius: 10px;
        background-color: white;
      "
    >
      <section
        id="alert-container"
        style="font-size: 60px; font-family: monospace; text-align: center"
      ></section>
    </div>

    <nav class="navbar bg-light">
      <div class="container">
        <a class="navbar-brand" href="#">
          <img src="/img/logo.png" alt="Bootstrap" width="120" height="auto" />
        </a>
        <a>
          <img src="/img/logo3.png" alt="Bootstrap" width="250" />
        </a>
        <a class="navbar-brand" href="#">
          <form id="round-form">
            <label for="round-select">Select a round:</label>
            <br />
            <select id="round-select" class="form-select form-select-lg mb-3">
              <option value="1">Round 1</option>
              <option value="2">Round 2</option>
              <option value="3">Round 3</option>
            </select>
            <button
              type="submit"
              class="btn btn-secondary"
              style="width: 14rem"
            >
              Go
            </button>
          </form>
        </a>
        <a class="navbar-brand" href="#">
          <span id="timer" style="font-size: 6rem">02:00</span>
        </a>
        <a class="navbar-brand" href="#">
          <button
            class="btn btn-secondary btn-lg"
            type="button"
            id="start-resume-button"
          >
            <i class="bi bi-play-fill"></i>
          </button>
          <button
            class="btn btn-secondary btn-lg"
            type="button"
            id="pause-button"
          >
            <i class="bi bi-pause-fill"></i>
          </button>
          <button
            class="btn btn-secondary btn-lg"
            type="button"
            id="restart-button"
          >
            <i class="bi bi-arrow-clockwise"></i>
          </button>
        </a>
        <a class="navbar-brand" href="#">
          <img src="/img/logo2.png" alt="Bootstrap" width="120" height="auto" />
        </a>
      </div>
    </nav>
    <br />

    <hr />
    <div class="container text-center">
      <div class="row">
        <div class="col">
          <div class="card-header" style="max-width: 9rem">Arbitre 1</div>
        </div>
        <div class="col">
          <div class="card-header" style="max-width: 9rem">Arbitre 2</div>
        </div>
        <div class="col">
          <div class="card-header" style="max-width: 9rem">Arbitre 3</div>
        </div>
        <div class="col">
          <div class="card-header" style="max-width: 9rem">Arbitre 4</div>
        </div>
        <div class="col">
          <div class="card-header" style="max-width: 9rem">Arbitre 5</div>
        </div>
        <div class="col">
          <div class="card-header" style="max-width: 14rem">Resulta</div>
        </div>
      </div>
      <!--round 1-->

      <div class="row">
        <div class="col">
          <div
            class="card card-assigned-value-round1"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card1" class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round1"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card2 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round1"
            id="A3R1"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card3 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round1"
            id="A4R1"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card4 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round1"
            id="A5R1"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card5" class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <!-- round result -->
        <div class="col">
          <div
            class="card"
            id="R1"
            style="max-width: 14rem; height: 4rem; background-color: gray"
            onclick="roundRes(1)"
          ></div>
        </div>
      </div>
      <!--round 2-->
      <div class="row">
        <div class="col">
          <div
            class="card card-assigned-value-round2"
            id="A1R2"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card1 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round2"
            id="A2R2"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card2 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round2"
            id="A3R2"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card3 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round2"
            id="A4R2"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card4" class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round2"
            id="A5R2"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card5 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <!-- round result -->
        <div class="col">
          <div
            class="card"
            id="R2"
            style="max-width: 14rem; height: 4rem; background-color: gray"
            onclick="roundRes(2)"
          ></div>
        </div>
      </div>
      <!--round 3-->
      <div class="row">
        <div class="col">
          <div
            class="card card-assigned-value-round3"
            id="A1R3"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card1 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round3"
            id="A2R3"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card2 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round3"
            id="A3R3"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card3 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round3"
            id="A4R3"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card4 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <div class="col">
          <div
            class="card card-assigned-value-round3"
            id="A5R3"
            style="max-width: 9rem; height: 4rem; background-color: gray"
          >
            <p id="card5 " class="nom-arbitre" style="font-size: 40px">0</p>
          </div>
        </div>
        <!-- round result -->
        <div class="col">
          <div
            class="card"
            id="R3"
            style="max-width: 14rem; height: 4rem; background-color: gray"
            onclick="roundRes(3)"
          ></div>
        </div>
      </div>
    </div>
    <br />

    <hr />
    <div class="container text-center">
      <div class="row align-items-start">
        <div class="col text-bg-primary">
          <h3>Cart pour Bleu</h3>
          <button
            class="btn btn-primary"
            type="button"
            onclick="incrementValuecardout_playerbleu()"
          >
            <img
              src="/img/out.png"
              style="
                width: 80px;
                height: 90px;
                margin-top: 15px;
                margin-bottom: 15px;
              "
            />
          </button>
          <button
            class="btn btn-primary"
            type="button"
            onclick="incrementValuecardyellow_playerbleu()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: yellow"
            ></i>
          </button>
          &nbsp;
          <button
            class="btn btn-primary"
            type="button"
            onclick="incrementValuecardbleu_playerbleu()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: blue"
            ></i>
          </button>
          &nbsp;
          <button
            class="btn btn-primary"
            type="button"
            onclick="incrementValuecardred_playerbleu()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: red"
            ></i>
          </button>
        </div>

        <div class="col text-bg-danger">
          <h3>Cart pour Rouge</h3>
          <button
            class="btn btn-danger"
            type="button"
            onclick="incrementValuecardout_playerred()"
          >
            <img
              src="/img/out.png"
              style="
                width: 80px;
                height: 90px;
                margin-top: 15px;
                margin-bottom: 15px;
              "
            />
          </button>
          &nbsp;
          <button
            class="btn btn-danger"
            type="button"
            onclick="incrementValuecardyellow_playerred()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: yellow"
            ></i>
          </button>
          &nbsp;
          <button
            class="btn btn-danger"
            type="button"
            onclick="incrementValuecardbleu_playerred()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: blue"
            ></i>
          </button>
          &nbsp;
          <button
            class="btn btn-danger"
            type="button"
            onclick="incrementValuecardred_playerred()"
          >
            <i
              class="bi bi-file-earmark-fill"
              style="font-size: 6rem; color: red"
            ></i>
          </button>
        </div>
      </div>
      
      <div class="row">
        <div class="col text-bg-primary" style="font-size: 2rem">
          <span id="incrementValuecardout_playerbleu" class="backtozero"
            >0</span
          >
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardyellow_playerbleu" class="backtozero"
            >0</span
          >
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardbleu_playerbleu">0</span>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardred_playerbleu">0</span>
        </div>

        <div class="col text-bg-danger" style="font-size: 2rem">
          <span id="incrementValuecardout_playerred" class="backtozero">0</span>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardyellow_playerred" class="backtozero"
            >0</span
          >
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardbleu_playerred">0</span>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <span id="incrementValuecardred_playerred">0</span>
        </div>
      </div>
    </div>
    <hr />
    <div class="container text-center">
      <div class="row">
        <div class="col text-bg-primary" style="font-size: 2rem; height: 12rem">
          <label for="bleuplayer" class="form-label">bleu player</label>
          <input
            type="text"
            class="form-control form-control-lg"
            id="bleuplayer"
            placeholder="le nom de bleu player"
          />
          <h5>Association</h5>
          <input
            type="text"
            class="form-control form-control-lg"
            id="bleuplayerassociation"
            placeholder="le nom de association"
          />
        </div>
        <div class="col col-3">
          <h3>Les catégories :</h3>
          <select
            class="form-select form-select-lg mb-3"
            aria-label=".form-select-lg example"
            id="categories"
          >
            <option selected>Choose...</option>
            <option value="48kg">48kg</option>
            <option value="52kg">52kg</option>
            <option value="56kg">56kg</option>
            <option value="60kg">60kg</option>
            <option value="65kg">65kg</option>
            <option value="70kg">70kg</option>
            <option value="75kg">75kg</option>
            <option value="80kg">80kg</option>
            <option value="85kg">85kg</option>
            <option value="90kg">90kg</option>
            <option value="+90kg">+90kg</option>
          </select>
          <div class="row">
            <div class="col">
              <input
                type="radio"
                class="btn-check"
                name="options-outlined"
                id="men"
                value="men"
                autocomplete="off"
              />
              <label
                class="btn btn-outline-dark"
                for="men"
                style="font-size: 30px"
              >
                &nbsp;&nbsp;&nbsp;Men&nbsp;&nbsp;&nbsp;
              </label>
            </div>
            <div class="col">
              <input
                type="radio"
                class="btn-check"
                name="options-outlined"
                id="women"
                value="women"
                autocomplete="off"
              />
              <label
                class="btn btn-outline-dark"
                for="women"
                style="font-size: 30px"
                >Women</label
              >
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div
                id="tv-player-redirection"
                class="btn btn-dark"
                style="margin: 10px; width: 14rem"
              >
                Go
              </div>
            </div>
          </div>
        </div>
        <div class="col text-bg-danger" style="font-size: 2rem; height: 12rem">
          <label for="redplayer" class="form-label">Red player</label>
          <input
            type="text"
            class="form-control form-control-lg"
            id="redplayer"
            placeholder="le nom de Rouge player"
          />
          <h5>Association</h5>
          <input
            type="text"
            class="form-control form-control-lg"
            id="redplayerassociation"
            placeholder="le nom de association"
          />
          <h7 style="font-size: 2px">&nbsp;</h7>
        </div>
      </div>
    </div>

    <div class="container text-center">
      <div class="row">
        <div class="col" style="font-size: 2rem">
          <h1>Winner :</h1>
          <button
            class="btn btn-primary btn-lg"
            id="redirect-button-blue"
            type="button"
          >
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i
              class="bi bi-person-fill"
              style="font-size: 4rem"
            ></i
            >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </button>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <button
            class="btn"
            id="redirect-equal"
            style="background: linear-gradient(to right, blue 50%, red 50%)"
            type="button"
          >
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <i class="bi bi-arrow-left-right" style="font-size: 4rem"></i>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </button>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <button class="btn btn-danger btn-lg" type="button">
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i
              class="bi bi-person-fill"
              id="redirect-button-red"
              style="font-size: 4rem"
            ></i
            >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </button>
        </div>
      </div>
    </div>

    <br /><br />
    <br /><br />
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      const arbitreIds = [];
      let pl1 = 0;
      let pl2 = 0;
      let resultro = 0;
      let bcount = 0;
      let rcount = 0;
      let timerInterval;
      let soundPlayedAlready = false;
      let soundPlayedAlready2 = false;
      let counterrsound = new Audio("/sound/countdown5s.mp3");
      let counterrsound2 = new Audio("/sound/countdown5s.mp3");
      let billsound = new Audio("/sound/bell.mp3");
      var Valuecardout_playerbleu = 0,
        Valuecardyellow_playerbleu = 0,
        Valuecardbleu_playerbleu = 0,
        Valuecardred_playerbleu = 0;
      var Valuecardout_playerred = 0,
        Valuecardyellow_playerred = 0,
        Valuecardbleu_playerred = 0,
        Valuecardred_playerred = 0;

      function showAlert(round) {
        $("#alert-container").html(
          `<div class="alert alert-success" role="alert">Round : ${round} !</div>`
        );

        var popup = document.querySelector(".popup");
        if (popup.style.display === "none") {
          popup.style.display = "block";
          setTimeout(function () {
            popup.style.display = "none";
          }, 2000);
        } else {
          popup.style.display = "none";
        }
      }

      const url = new URL(window.location.href);
      const vurl = url.pathname.split("/")[0];
      console.log(vurl);
      const username = url.pathname.split("/")[1];
      const role = url.pathname.split("/")[2];
      const roomid = url.pathname.split("/")[3];

      socket.on("connect", () => {
        // Get the URL and parse it
        console.log(
          `${username} connected to server as ${role} in room ${roomid}`
        );
        socket.emit("login", { username, role, roomid });
      });

      socket.emit("request-values");

      // Initialize a variable to store the values object on the admin page
      let values = {
        1: [],
        2: [],
        3: [],
      };

      // Listen for the "receive-values" event emitted by the server
      socket.on("receive-values", (data) => {
        console.log(
          "round : " +
            data.round +
            " AN : " +
            data.arbitreName +
            " Winner : " +
            data.winner
        );
        const receivedRound = data.round;
        const receivedArbitreName = data.arbitreName;
        const receivedWinner = data.winner;

        // Push the received values into the corresponding array based on the round number
        values[receivedRound].push({ receivedArbitreName, receivedWinner });

        console.log("This is ur value from admin bofere assignment  " + JSON.stringify(values) );
        //nom-arbitre

        let cardsRound1 = document.querySelectorAll(
          ".card-assigned-value-round1"
        );
        let cardsRound2 = document.querySelectorAll(
          ".card-assigned-value-round2"
        );
        let cardsRound3 = document.querySelectorAll(
          ".card-assigned-value-round3"
        );

        console.log(cardsRound1 + " " + cardsRound2 + " " + cardsRound3);

        // Check that the values object is defined before accessing its properties
        if (values) {
          // Update the values for round 1
          cardsRound1.forEach((card, index) => {
            if (values[1] && values[1][index]) {
              card.innerHTML = receivedArbitreName;
              if (values[1][index].receivedWinner === "player1") {
                card.style.backgroundColor = "blue";
              } else if (values[1][index].receivedWinner === "player2") {
                card.style.backgroundColor = "red";
              } else if (values[1][index].receivedWinner === "equal") {
                card.style.backgroundColor = "green";
              }
            }
          });
          // Update the values for round 2
          cardsRound2.forEach((card, index) => {
            if (values[2] && values[2][index]) {
              card.innerHTML = receivedArbitreName;
              if (values[2][index].receivedWinner === "player1") {
                card.style.backgroundColor = "blue";
              } else if (values[2][index].receivedWinner === "player2") {
                card.style.backgroundColor = "red";
              } else if (values[2][index].receivedWinner === "equal") {
                card.style.backgroundColor = "green";
              }
            }
          });
          // Update the values for round 3
          cardsRound3.forEach((card, index) => {
            if (values[3] && values[3][index]) {
              card.innerHTML = receivedArbitreName;
              if (values[3][index].receivedWinner === "player1") {
                card.style.backgroundColor = "blue";
              } else if (values[3][index].receivedWinner === "player2") {
                card.style.backgroundColor = "red";
              } else if (values[3][index].receivedWinner === "equal") {
                card.style.backgroundColor = "green";
              }
            }
          });
        }
      });

      //////////////////////////////////////////////////////////////////////////////////////////////
      const round = document.getElementById("round-select").value;
      // Emit the 'request-values' event to the server when the page loads
      window.addEventListener("load", () => {
        socket.emit("request-values");
      });

      // Add event listener to the form
      document
        .getElementById("round-form")
        .addEventListener("submit", (event) => {
          event.preventDefault();
          rcount = 0;
          bcount = 0;

          const url3 = `${vurl}/${username}/tv/${roomid}`;
          socket.emit("redirect-player-to-tv", url3);
          console.log("redirect players to tv " + url3);

          // Get the selected round value
          const round = document.getElementById("round-select").value;
          showAlert(round);
          console.log("alert shown");

          Valuecardout_playerred = 0;
          Valuecardout_playerbleu = 0;
          Valuecardyellow_playerbleu = 0;
          Valuecardbleu_playerbleu = 0;
          Valuecardred_playerbleu = 0;
          Valuecardyellow_playerred = 0;
          Valuecardbleu_playerred = 0;
          Valuecardred_playerred = 0;
          document.querySelectorAll(".backtozero").forEach((back) => {
            back.innerHTML = 0;
          });

          // Emit the selected round value to the server
          socket.emit("select-round", round);
        });

      /////////////////////////////////////////////////////////////////////////////////////////////////
      //tv players redirections
      const goTvPlayers = document.getElementById("tv-player-redirection");
      goTvPlayers.addEventListener("click", () => {
        const radioGroup = document.getElementsByName("options-outlined");

        let selectedValue;

        for (let i = 0; i < radioGroup.length; i++) {
          const radioButton = radioGroup[i];
          if (radioButton.checked) {
            selectedValue = radioButton.value;
            break;
          }
        }

        const pblue1 = document.getElementById("bleuplayer").value;
        const pblue2 = document.getElementById("bleuplayerassociation").value;
        const pblue3 = document.getElementById("categories").value;

        ///

        const radiop4 = selectedValue;

        /////

        const pred1 = document.getElementById("redplayer").value;
        const pred2 = document.getElementById("redplayerassociation").value;

        const url2 = `${vurl}/${username}/tvplayers/${roomid}?param1=${pblue1}&param2=${pblue2}&param3=${pblue3}&param4=${radiop4}&param5=${pred1}&param6=${pred2}`;
        socket.emit("redirect-tv-to-players", url2);
        console.log("redirect to tv players " + url2);
      });

      /////////////////////////////////////////////////////////////////////////////////////////////////

      // Declare a variable to store the timer interval

      // Declare a variable to store the timer value in seconds
      let timerValue = 120;

      // Declare a function to start the timer
      function startTimer() {
        // If the timer interval is already set, do nothing
        if (timerInterval) {
          return;
        }

        // Set the timer interval to decrement the timer value by 1 second every 1000 milliseconds (1 second)
        timerInterval = setInterval(() => {
          // Decrement the timer value by 1 second
          timerValue--;
          if (timerValue <= 11 && !soundPlayedAlready) {
            soundPlayedAlready = true;
            counterrsound.play();
            console.log("/sound played one");
          }
          if (timerValue <= 6 && !soundPlayedAlready2) {
            soundPlayedAlready2 = true;
            counterrsound2.play();
            console.log("/sound played two");
          }

          // If the timer value is less than or equal to 0, clear the interval and reset the timer value to 0
          if (timerValue < 1) {
            clearInterval(timerInterval);
            timerValue = 0;
            billsound.play();
            console.log("final sound");
          }

          // Update the timer element to display the current timer value in the format mm:ss
          timer.innerText = `${("0" + Math.floor(timerValue / 60)).slice(
            -2
          )}:${("0" + (timerValue % 60)).slice(-2)}`;
        }, 1000);
      }

      // Declare a function to pause the timer
      function pauseTimer() {
        counterrsound.pause();
        counterrsound2.pause();
        // If the timer interval is not set, do nothing
        if (!timerInterval) {
          return;
        }
        // Clear the timer interval
        clearInterval(timerInterval);
        // Reset the timer interval variable
        timerInterval = null;
      }

      // Declare a function to restart the timer
      function restartTimer() {
        // Clear the timer interval
        clearInterval(timerInterval);

        // Reset the timer interval variable
        timerInterval = null;

        counterrsound.pause();
        counterrsound2.pause();
        // Reset the timer value to 120 seconds
        timerValue = 120;

        // Update the timer element to display the reset timer value in the format mm:ss
        timer.innerText = `${("0" + Math.floor(timerValue / 60)).slice(-2)}:${(
          "0" +
          (timerValue % 60)
        ).slice(-2)}`;
      }

      document
        .getElementById("start-resume-button")
        .addEventListener("click", () => {
          startTimer();
          socket.emit("start-timer-admin");
        });

      document.getElementById("pause-button").addEventListener("click", () => {
        pauseTimer();
        socket.emit("pause-timer-admin");
      });

      document
        .getElementById("restart-button")
        .addEventListener("click", () => {
          restartTimer();
          socket.emit("restart-timer-admin");
        });

      //redirect

      function winnerblue() {
        showAlert3("blue");
        const param1 = document.getElementById("bleuplayer").value;
        console.log(param1);
        const param2 = document.getElementById("bleuplayerassociation").value;
        const param3 = document.getElementById("categories").value;

        const radioGroup = document.getElementsByName("options-outlined");

        let selectedValue;

        for (let i = 0; i < radioGroup.length; i++) {
          const radioButton = radioGroup[i];
          if (radioButton.checked) {
            selectedValue = radioButton.value;
            break;
          }
        }

        console.log(selectedValue); // logs the value of the selected radio butto
        const param4 = selectedValue;
        const param5 = "blue";

        console.log(
          param1 + " " + param2 + " " + param3 + " " + param4 + " " + param5
        );

        const url = `${vurl}/${username}/winner/${roomid}?param1=${param1}&param2=${param2}&param3=${param3}&param4=${param4}&param5=${param5}`;
        socket.emit("redirect-tv-to-winner", url);
        console.log("redirect the tv to winner");
      }

      document
        .getElementById("redirect-button-blue")
        .addEventListener("click", () => {
          winnerblue();
        });

      //////////////////////////////////////////////////////////////////////////////////////////////
      const r1 = document.getElementById("R1");

      function findWinner(pl1, pl2) {
        console.log(pl1 + "  " + pl2);
        if (pl1 > pl2) {
          bcount++;
        } else if (pl1 < pl2) {
          rcount++;
        }
      }

      r1.addEventListener("click", () => {
        console.log("r1 " + bcount + " " + rcount);
        if (bcount > rcount) {
          r1.style.backgroundColor = "blue";
        } else if (rcount > bcount) {
          r1.style.backgroundColor = "red";
        } else {
          r1.style.backgroundColor = "green";
        }
      });
      const r2 = document.getElementById("R2");
      r2.addEventListener("click", () => {
        if (bcount > rcount) {
          r2.style.backgroundColor = "blue";
        } else if (rcount > bcount) {
          r2.style.backgroundColor = "red";
        } else {
          r2.style.backgroundColor = "green";
        }
      });
      const r3 = document.getElementById("R3");
      r3.addEventListener("click", () => {
        if (bcount > rcount) {
          r3.style.backgroundColor = "blue";
        } else if (rcount > bcount) {
          r3.style.backgroundColor = "red";
        } else {
          r3.style.backgroundColor = "green";
        }
      });

      function roundRes(round) {
        const roundValues = values[round];
        const results = {};

        for (const { arbitreName, winner } of roundValues) {
          if (!results[arbitreName]) {
            results[arbitreName] = 0;
          }
          if (winner === "blue") {
            results[arbitreName]++;
          } else if (winner === "red") {
            results[arbitreName]--;
          }
        }

        return results;
      }

      function winnerRed() {
        showAlert3("red");
        const param1 = document.getElementById("redplayer").value;
        const param2 = document.getElementById("redplayerassociation").value;
        const param3 = document.getElementById("categories").value;

        const radioGroup = document.getElementsByName("options-outlined");

        let selectedValue;

        for (let i = 0; i < radioGroup.length; i++) {
          const radioButton = radioGroup[i];
          if (radioButton.checked) {
            selectedValue = radioButton.value;
            break;
          }
        }

        console.log(selectedValue); // logs the value of the selected radio button

        const param4 = selectedValue;
        const param5 = "red";

        console.log(
          param1 + " " + param2 + " " + param3 + " " + param4 + " " + param5
        );
        console.log(param1, param2, param3, radioGroup, selectedValue);

        const url = `${vurl}/${username}/winner/${roomid}?param1=${param1}&param2=${param2}&param3=${param3}&param4=${param4}&param5=${param5}`;
        socket.emit("redirect-tv-to-winner", url);
        console.log("redirect the tv to winner");
      }

      /////////////////////////////////////////////////////////////////////////
      document
        .getElementById("redirect-button-red")
        .addEventListener("click", () => {
          winnerRed();
        });

      /////////////////////////////////////////////////////////////////////////////////

      document
        .getElementById("redirect-equal")
        .addEventListener("click", () => {
          const param1 = "Egualité";
          const param2 = "-";
          const param3 = "-";
          const param4 = "-";
          const param5 = "green";

          console.log(
            param1 + " " + param2 + " " + param3 + " " + param4 + " " + param5
          );

          const url = `${vurl}/${username}/winner/${roomid}?param1=${param1}&param2=${param2}&param3=${param3}&param4=${param4}&param5=${param5}`;
          socket.emit("redirect-tv-to-winner", url);
          console.log("redirect the tv to winner");
        });

      function showAlert2(round, countIn) {
        //change color to red
        $("#alert-container").html(
          `<div class="alert alert-success" role="alert">Winner in round ${round} : ${countIn}!</div>`
        );

        var popup = document.querySelector(".popup");
        if (popup.style.display === "none") {
          popup.style.display = "block";
          setTimeout(function () {
            popup.style.display = "none";
          }, 5000);
        } else {
          popup.style.display = "none";
        }
      }

      function showAlert3(winr) {
        //change color to red

        if (winr === "blue") {
          $("#alert-container").html(`<div class="alert alert-success" style="
                    background-color: ${winr};
                    color: #fff; role="alert">Fin de match winner :  ${winr} !</div>`);
        } else if (winr === "red") {
          $("#alert-container").html(`<div class="alert alert-success" style="
                    background-color: ${winr};
                    color: #fff; role="alert">Fin de match winner :  ${winr} !</div>`);
        }

        var popup = document.querySelector(".popup");
        if (popup.style.display === "none") {
          popup.style.display = "block";
          setTimeout(function () {
            popup.style.display = "none";
          }, 10000);
        } else {
          popup.style.display = "none";
        }
      }
      // increment Value card blue plyredaer
      function incrementValuecardout_playerbleu() {
        Valuecardout_playerbleu++;
        document.getElementById("incrementValuecardout_playerbleu").innerHTML =
          Valuecardout_playerbleu;
        if (Valuecardout_playerbleu == 2) {
          showAlert2(round, "red");
          socket.emit("outcard", "red");
        }
      }
      function incrementValuecardout_playerred() {
        Valuecardout_playerred++;
        document.getElementById("incrementValuecardout_playerred").innerHTML =
          Valuecardout_playerred;
        if (Valuecardout_playerred == 2) {
          showAlert2(round, "blue");
          socket.emit("outcard", "blue");
        }
      }

      function incrementValuecardyellow_playerbleu() {
        Valuecardyellow_playerbleu++;
        document.getElementById(
          "incrementValuecardyellow_playerbleu"
        ).innerHTML = Valuecardyellow_playerbleu;
      }
      function incrementValuecardbleu_playerbleu() {
        Valuecardbleu_playerbleu++;
        document.getElementById("incrementValuecardbleu_playerbleu").innerHTML =
          Valuecardbleu_playerbleu;
        //
        if (Valuecardbleu_playerbleu == 3) {
          winnerRed();
        }
      }
      function incrementValuecardred_playerbleu() {
        Valuecardred_playerbleu++;
        document.getElementById("incrementValuecardred_playerbleu").innerHTML =
          Valuecardred_playerbleu;
        //
        if (Valuecardred_playerbleu == 3) {
          winnerRed();
        }
      }
      // increment Value card red plyredaer
      function incrementValuecardyellow_playerred() {
        Valuecardyellow_playerred++;
        document.getElementById(
          "incrementValuecardyellow_playerred"
        ).innerHTML = Valuecardyellow_playerred;
      }
      function incrementValuecardbleu_playerred() {
        Valuecardbleu_playerred++;
        document.getElementById("incrementValuecardbleu_playerred").innerHTML =
          Valuecardbleu_playerred;
        //
        if (Valuecardbleu_playerred == 3) {
          winnerblue();
        }
      }
      function incrementValuecardred_playerred() {
        Valuecardred_playerred++;
        document.getElementById("incrementValuecardred_playerred").innerHTML =
          Valuecardred_playerred;
        //
        if (Valuecardred_playerred == 3) {
          winnerblue();
        }
      }

      window.addEventListener("beforeunload", function (e) {
        e.preventDefault();
        e.returnValue = "";
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"
      integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
